---
// src/components/CommentsPanel.astro
import { COMMENTS_CONFIG, UI_TEXT } from '@/consts';

const apiBase = import.meta.env.PUBLIC_COMMENTS_API_BASE ?? COMMENTS_CONFIG?.API_BASE ?? '';
const commentsPanelConfig = JSON.stringify({
  apiBase,
  uiText: UI_TEXT,
});
---
<nav
  id="comments-panel"
  data-config={commentsPanelConfig}
  class="hidden xl:block fixed top-1/2 -translate-y-1/2 left-[calc(50%+576px+1rem)] w-[320px] space-y-2 p-4 rounded-lg shadow-lg backdrop-blur-md border overflow-y-auto z-50 bg-[var(--card-bg)] border-[color:var(--border-color)]"
>
  <h3 class="font-bold text-lg mb-3 text-[var(--text-color)]">{UI_TEXT.commentsTitle}</h3>
  <div id="comments-session" class="mb-3 text-sm text-[var(--text-secondary)]"></div>
  <div id="comments-status" class="text-sm text-[var(--text-secondary)] hidden"></div>
  <div id="comments-list" class="space-y-4 overflow-auto pr-1"></div>

  <div id="comments-editor" class="mt-4">
    <textarea id="comment-input" class="w-full p-2 rounded border border-[color:var(--border-color)] bg-transparent text-[var(--text-color)] resize-y" rows="3" placeholder={UI_TEXT.commentPlaceholder}></textarea>
    <div class="mt-2 flex items-center justify-between">
      <a id="login-link" href="#" class="hidden text-sm text-[var(--accent-color)] hover:underline">{UI_TEXT.loginWithGitHub}</a>
      <button id="comment-submit" class="ml-auto px-3 py-1 rounded border border-[color:var(--border-color)] text-[var(--text-color)] hover:shadow-soft-md">{UI_TEXT.commentSubmit}</button>
    </div>
  </div>
</nav>

<script is:inline type="module" src="/scripts/comments-panel.js"></script>
